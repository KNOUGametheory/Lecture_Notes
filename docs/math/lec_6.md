---
layout: default
title: 조건부 확률과 사전-사후 확률
parent: 게임이론을 위한 수학
nav_order: 6
---


# 조건부 확률과 사전-사후 확률


## 사전확률과 사후확률의 응용

- 핵심만 쏙쏙!

    {: .note}
	> - 사전적으로 주어진 확률을 알면 베이즈 정리를 활용하여 사후확률을 구할 때 응용할 수 있다. 
	>
	> - 정보가 불완전한 상황을 묘사하는 베이지안 게임의 경우에 경기자가 분명히 모르는 상대방의 유형(type)에 따라 자신의 보수가 결정된다.
	>	
	> - 상대방의 유형(type)에 대한 조건부 확률을 이용하여 각 경기자는 자신의 기대보수를 계산하고, 이를 바탕으로 베이지안 균형을 도출할 수 있다.

### 원인과 결과

- $$A_{i}~~i=1,~2,~3$$는 원인을, $$B_{j}~~j=1,~2,~3,~4$$는 결과라고 하자.

- 다음의 표를 완성하고 $$P(B_{j}) ~~j=1,~2,~3,~4$$를 구하라.

  ![예시표](/images/Lec_6_2_7.png)
  
- 표를 완성하면

  ![예시표](/images/Lec_6_2_8.png)

   - $$P(B_{1})=0.4\times0.2+0.2\times0.5+0.1\times0.3=0.21$$

   - $$P(B_{2})=0.15\times0.2+0.4\times0.5+0.3\times0.3=0.32$$

   - $$P(B_{3})=0.35\times0.2+0.15\times0.5+0.45\times0.3=0.28$$

   - $$P(B_{4})=0.1\times0.2+0.25\times0.5+0.15\times0.3=0.19$$


### 사전확률(초기확률)(prior probability)

- 상호배반이며 전체를 이루는 가능한 가설 $$n$$개 있다고 하자.

$$\sum_{i=1}^{n}P(H_{i})=1$$

### 사후확률(posterior probability) 또는 갱신될 확률(updated probability)

- 사건 $$E$$가 발생했다는 정보를 접하면 $$H_{i}$$가 참인 가설일 조건부확률

$$P(H_{i}\vert E)=\frac{P(E\vert H_{i})P(H_{i})}{\sum_{j=1}^{n}P(E\vert H_{j})P(H_{j})}$$

- $$E_{1}$$ 발생

	- 사건 $$E_{1}$$가 발생했다는 정보를 접하면 $$H_{i}$$가 참인 가설일 조건부확률

$$P(H_{i}\vert E_{1})=\frac{P(E_{1}\vert H_{i})P(H_{i})}{\sum_{j=1}^{n}P(E_{1}\vert H_{j})P(H_{j})}$$	

- $$E_{1}$$ 발생 후 $$E_{2}$$ 발생 $\rightarrow$ $$E_{1}E_{2}=E_{1}\cap E_{2}$$

	- 추가로 사건 $$E_{2}$$가 발생했다는 정보를 접하면 $$H_{i}$$가 참인 가설일 조건부확률

$$P(H_{i}\vert E_{1}E_{2})=\frac{P(E_{1}E_{2}\vert H_{i})P(H_{i})}{\sum_{j=1}^{n}P(E_{1}E_{2}\vert H_{j})P(H_{j})}$$

- $$E_{1}$$과 $$E_{2}$$가 조건부 독립이라면

	- 추가로 사건 $$E_{2}$$가 발생했다는 정보를 접하면 $$H_{i}$$가 참인 가설일 조건부확률

$$\begin{split}
		P(E_{1}E_{2}\vert H_{j})&=P(E_{2}\vert H_{j})P(E_{1}\vert H_{j})~~~~~for~j=1,~2,\cdots,~n\\
		P(H_{i}\vert E_{1}E_{2})&=\frac{P(E_{1}E_{2}\vert H_{i})P(H_{i})}{P(E_{1}E_{2})}
		=\frac{P(E_{2}\vert H_{i})P(E_{1}\vert H_{i})P(H_{i})}{P(E_{1}E_{2})}\\
		&=\frac{P(E_{2}\vert H_{i})P(E_{1}\cap H_{i})}{P(E_{1}E_{2})}
		=\frac{P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})P(E_{1})}{P(E_{1}E_{2})}\\
		&=\frac{P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})P(E_{1})}{P(E_{1}E_{2})}\\
		&=\frac{P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})}{Q(1,~2)}~~~~~~~~~~~\because
		Q(1,~2)=\frac{P(E_{1}E_{2})}{P(E_{1})}\\
		\end{split}$$

   - 모든 $$i$$에 대해서 위의 식이 타당하기에

$$\begin{split}
		1=\sum_{i=1}^{n}P(H_{i}\vert E_{1}E_{2})&=\sum_{i=1}^{n}\frac{P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})}{Q(1,~2)}\~~~~~~~~
		\therefore Q(1,~2)=\sum_{i=1}^{n}P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})\\
		\end{split}$$
		
   - 따라서, 다음과 같은 결론을 얻는다.

$$
P(H_{i}\vert E_{1}E_{2})=\frac{P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})}{\sum_{i=1}^{n}P(E_{2}\vert H_{i})P(H_{i}\vert E_{1})}$$





## 정리하기

- 게임이론에 응용하여 답할 수 있다.

	- 정보가 주어지면 상대방이 어떤 전략을 가지고 있는지 파악할 수 있다.

	- 상대방의 전략에 따라 자신의 최적 대응을 구할 수 있다.